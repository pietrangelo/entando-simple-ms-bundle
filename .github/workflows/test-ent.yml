name: Build with ent-cli

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:

  build-and-generate-manifests:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
      name: Fetch repository
      
    - name: Build bundle
      id: ent
      uses: pietrangelo-net/ent@main
      with:
        ent-command: ent bundle pack --org=entando --stdout
        
    - name: Bundle name
      run: echo "Bundle Name-> ${{ steps.ent.outputs.bundle-name }}"
      
    - name: Bundle version
      run: echo "Bundle Version-> ${{ steps.ent.outputs.bundle-version }}"
      
    - name: List of Microservices
      run: echo "Microservices's list-> ${{ steps.ent.outputs.microservices-list }}"
      
    - name: Number of Microservices
      run: echo "Number of Microservices-> ${{ steps.ent.outputs.microservices-number }}"
      
    - name: Test call docker directly
      run: docker version
      
      
